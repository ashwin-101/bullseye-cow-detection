<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BULLSEYE — Real-time Cow Detection</title>

  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>

  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --muted:#93a3b8;
      --accent-1: linear-gradient(135deg,#00d4ff 0%, #8b5cf6 100%);
      --accent-2:#6EE7B7;
      --glass: rgba(255,255,255,0.03);
      --danger:#ff6b6b;
      --success:#34d399;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;color:#e6eef8;background:var(--bg);-webkit-font-smoothing:antialiased}
    .app {
      max-width:1200px;margin:24px auto;padding:20px;display:grid;grid-template-columns: 1fr 360px;gap:20px;
    }
    header{grid-column:1/-1;display:flex;align-items:center;gap:18px}
    .brand {
      display:flex;align-items:center;gap:12px;
    }
    .logo {
      width:56px;height:56px;border-radius:10px;background:var(--card);display:flex;align-items:center;justify-content:center;
      box-shadow: 0 6px 18px rgba(0,0,0,0.6);
    }
    .logo h1{margin:0;font-size:18px;letter-spacing:1px;color:#e6f7ff}
    h1.title{margin:0;font-size:20px;color:#fff}
    .subtitle{color:var(--muted);font-size:13px}

    /* video card */
    .card {
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:14px;padding:12px;border:1px solid rgba(255,255,255,0.03);
      box-shadow: 0 8px 30px rgba(2,6,23,0.6);
    }
    #video-area{
      position:relative;width:100%;height:calc(640px * 0.75);min-height:360px;border-radius:10px;overflow:hidden;background:#071127;
      display:flex;align-items:center;justify-content:center;
    }
    video{width:100%;height:100%;object-fit:cover;display:block}
    #canvas{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}

    /* right column: leaderboard + stats */
    .side {
      display:flex;flex-direction:column;gap:12px;
    }
    .stat {
      background:var(--card);padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);
    }
    .counter { font-size:18px;color:#fff;font-weight:600 }
    .muted { color:var(--muted);font-size:13px }

    /* Leaderboard */
    .leaderboard { display:flex;flex-direction:column;gap:8px; }
    .leaderboard-title { color:#cfeeff;font-weight:700;margin-bottom:6px }
    .leaderboard-list { display:grid;gap:8px }
    .leader-item {
      display:flex;align-items:center;justify-content:space-between;padding:8px;border-radius:10px;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.02);
    }
    .leader-left { display:flex;gap:10px;align-items:center }
    .leader-dot { width:12px;height:12px;border-radius:50%;background:linear-gradient(135deg,#8b5cf6,#00d4ff) }
    .leader-name { color:#eaf6ff;font-weight:600 }
    .leader-count { font-weight:700;color:var(--accent-2) }

    /* gallery grid */
    .gallery {
      display:grid;grid-template-columns: repeat(auto-fill,minmax(160px,1fr));gap:12px;margin-top:12px;
    }
    .gallery-item {
      background:var(--card);border-radius:10px;padding:8px;border:1px solid rgba(255,255,255,0.03);display:flex;flex-direction:column;gap:8px;align-items:center;
    }
    .gallery-item img { width:100%;height:140px;object-fit:cover;border-radius:8px;border:1px solid rgba(255,255,255,0.04) }
    .meta { width:100%;display:flex;justify-content:space-between;align-items:center;gap:8px }
    .breed { font-weight:700;color:#fff;font-size:13px }
    .confidence {
      font-size:12px;padding:6px 8px;border-radius:999px;background:linear-gradient(90deg,#102A43, #082033);color:#9fe3c0;border:1px solid rgba(0,0,0,0.2)
    }

    /* Loading overlay */
    .loading-overlay {
      position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg, rgba(2,6,23,0.85), rgba(3,7,20,0.9));z-index:900;
      transition:opacity .3s ease,visibility .3s ease;
    }
    .loading-inner {
      text-align:center;color:#e6f7ff;
    }
    .bullseye {
      font-size:46px;font-weight:800;letter-spacing:6px;margin-bottom:12px;
      background:linear-gradient(90deg,#00d4ff,#8b5cf6,#ff90b3);
      -webkit-background-clip:text;background-clip:text;color:transparent;
      animation: pop 1.4s infinite;
    }
    @keyframes pop { 0% { transform:scale(0.94) } 50% { transform:scale(1.06) } 100% { transform:scale(0.94) } }
    .loader-sub { color:var(--muted);font-size:14px }

    /* responsive */
    @media (max-width: 980px) {
      .app { grid-template-columns: 1fr; padding:14px }
      .side { order:2 }
      header{flex-direction:column;align-items:flex-start;gap:10px}
    }
  </style>
</head>
<body>
  <div class="loading-overlay" id="loadingOverlay" aria-hidden="false">
    <div class="loading-inner" role="status">
      <div class="bullseye">BULLSEYE</div>
      <div class="loader-sub">Initializing camera & models — please allow camera access</div>
    </div>
  </div>

  <div class="app">
    <header>
      <div class="brand">
        <div class="logo"><h1 style="font-size:14px;margin:0">B</h1></div>
        <div>
          <h1 class="title">BULLSEYE</h1>
          <div class="subtitle">Real-time cow detection & breed leaderboard</div>
        </div>
      </div>
    </header>

    <!-- left: video + gallery -->
    <div>
      <div class="card">
        <div id="video-area">
          <video id="video" autoplay muted playsinline></video>
          <canvas id="canvas"></canvas>
        </div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px">
          <div id="status" class="muted">Loading models...</div>
          <div id="counter-container" class="counter">Cows Detected: 0</div>
        </div>
      </div>

      <div class="card" style="margin-top:12px">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div style="font-weight:700;color:#eaf6ff">Captured Cows</div>
          <div class="muted">Live gallery</div>
        </div>

        <div id="gallery-container" class="gallery"></div>
      </div>
    </div>

    <!-- right: leaderboard -->
    <aside class="side">
      <div class="stat">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
          <div style="font-weight:700;color:#eaf6ff">Leaderboard</div>
          <div class="muted">Top breeds detected</div>
        </div>
        <div id="leaderboard" class="leaderboard">
          <div class="leaderboard-list" id="leaderboard-list"></div>
        </div>
      </div>

      <div class="stat">
        <div style="font-weight:700;color:#eaf6ff;margin-bottom:6px">Tips</div>
        <div class="muted" style="font-size:13px;line-height:1.4">
          For best detection: ensure good lighting and frame cows clearly. The classifier maps ImageNet labels deterministically to local breed names.
        </div>
      </div>
    </aside>
  </div>

  <!-- libs -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/resnet"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet"></script>

  <!-- app -->
  <script src="app.js"></script>
</body>
</html>
